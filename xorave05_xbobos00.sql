DROP TABLE Lekaren CASCADE CONSTRAINTS;
DROP TABLE Vykaz CASCADE CONSTRAINTS;
DROP TABLE Nakup CASCADE CONSTRAINTS;
DROP TABLE Liek CASCADE CONSTRAINTS;
DROP TABLE Zdravotna_poistovna CASCADE CONSTRAINTS;
DROP TABLE Sklad CASCADE CONSTRAINTS;

create table LEKAREN
(
    ADRESA_POBOCKY  VARCHAR(50) not null,
    TELEFONNE_CISLO CHAR(13),
    DATUM_INVENTURY DATE,
    CHECK ( REGEXP_LIKE(TELEFONNE_CISLO, '^\+421\d{9}$') )
)
/

create table VYKAZ
(
    ID_VYKAZU int GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) not null,
    DATUM_VYHOTOVENIA DATE
)
/

create table NAKUP
(
    CISLO_POKLADNICNEHO_BLOKU int GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) not null,
    DATUM_PREDAJA             DATE,
    ZAKUPENY_TOVAR            VARCHAR(30)
)
/

create table LIEK
(
    NAZOV_LIEKU      VARCHAR(50) not null,
    CENA             DECIMAL(5, 2),
    DENNA_DAVKA      VARCHAR(70),
    UCINNA_LATKA     VARCHAR(150),
    EXPIRACIA        DATE,
    VEDLAJSIE_UCINKY VARCHAR(150)
)
/

create table ZDRAVOTNA_POISTOVNA
(
    ID_POISTOVNE int GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) not null,
    PLATNOST_ZMLUVY DATE
)
/

create table SKLAD
(
    ID_SKLADU int GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) not null,
    MNOZSTVO_TOVARU_NA_SKLADE NUMBER,
    KAPACITA                  NUMBER,
    CHECK (MNOZSTVO_TOVARU_NA_SKLADE <= KAPACITA)
)
/

ALTER TABLE LEKAREN ADD CONSTRAINT pk_lekaren PRIMARY KEY(ADRESA_POBOCKY);
ALTER TABLE VYKAZ ADD CONSTRAINT pk_vykaz PRIMARY KEY(ID_VYKAZU);
ALTER TABLE NAKUP ADD CONSTRAINT pk_nakup PRIMARY KEY(CISLO_POKLADNICNEHO_BLOKU);
ALTER TABLE LIEK ADD CONSTRAINT pk_liek PRIMARY KEY(NAZOV_LIEKU);
ALTER TABLE ZDRAVOTNA_POISTOVNA ADD CONSTRAINT pk_poistovna PRIMARY KEY(ID_POISTOVNE);
ALTER TABLE SKLAD ADD CONSTRAINT pk_sklad PRIMARY KEY(ID_SKLADU);

INSERT INTO LEKAREN(ADRESA_POBOCKY, TELEFONNE_CISLO, DATUM_INVENTURY) VALUES('Antona Bernoláka 2135/2, Žilina','+421901961271',TO_DATE('01.03.2020', 'dd.mm.yyyy'));
INSERT INTO LEKAREN(ADRESA_POBOCKY, TELEFONNE_CISLO, DATUM_INVENTURY) VALUES('Legionárska 19, Trenčín','+421901961504',TO_DATE('10.03.2020', 'dd.mm.yyyy'));
INSERT INTO LEKAREN(ADRESA_POBOCKY, TELEFONNE_CISLO, DATUM_INVENTURY) VALUES('Betliarska 3776/17, Bratislava','+421901961312',TO_DATE('08.03.2020', 'dd.mm.yyyy'));

INSERT INTO VYKAZ(DATUM_VYHOTOVENIA) VALUES(TO_DATE('11.03.2020', 'dd.mm.yyyy'));
INSERT INTO VYKAZ(DATUM_VYHOTOVENIA) VALUES(TO_DATE('11.03.2020', 'dd.mm.yyyy'));
INSERT INTO VYKAZ(DATUM_VYHOTOVENIA) VALUES(TO_DATE('12.03.2020', 'dd.mm.yyyy'));

INSERT INTO NAKUP(DATUM_PREDAJA, ZAKUPENY_TOVAR) VALUES(TO_DATE('08.03.2020', 'dd.mm.yyyy'),'CURAPROX CS 5460 ultrasoft');
INSERT INTO NAKUP(DATUM_PREDAJA, ZAKUPENY_TOVAR) VALUES(TO_DATE('10.02.2020', 'dd.mm.yyyy'),'Dr.Max Magnesium B6 250 mg');
INSERT INTO NAKUP(DATUM_PREDAJA, ZAKUPENY_TOVAR) VALUES(TO_DATE('12.12.2019', 'dd.mm.yyyy'),'Condrosulf 400 mg');

INSERT INTO LIEK(NAZOV_LIEKU, CENA, DENNA_DAVKA, UCINNA_LATKA, EXPIRACIA, VEDLAJSIE_UCINKY) VALUES ('Dr.Max Magnesium B6 250 mg','2,99','1 šumivá tableta denne','horčík a vitamín B6',TO_DATE('20.03.2021','dd.mm.yyyy'),'laxatívne účinky');
INSERT INTO LIEK(NAZOV_LIEKU, CENA, DENNA_DAVKA, UCINNA_LATKA, EXPIRACIA, VEDLAJSIE_UCINKY) VALUES ('Wobenzym','99,89','3-krát 5 až 3-krát 10 tabliet denne','pankreatín, amyláza, lipáza, bromelaín, trypsín, papaín, chymotrypsín, rutozid trihydrát',TO_DATE('03.08.2021','dd.mm.yyyy'),'nevýrazná zmena konzistencie, farby a zápachu stolice, pocit plnosti');
INSERT INTO LIEK(NAZOV_LIEKU, CENA, DENNA_DAVKA, UCINNA_LATKA, EXPIRACIA, VEDLAJSIE_UCINKY) VALUES ('Orinox 1 mg/ml','3,69','1 vstrek do každej nosovej dierky maximálne 3x denne','xylometazolíniumchlorid',TO_DATE('09.12.2020','dd.mm.yyyy'),'bolesti hlavy,nevoľnosť,krvácanie z nosa,zvýšený krvný tlak');

INSERT INTO ZDRAVOTNA_POISTOVNA(PLATNOST_ZMLUVY) VALUES(TO_DATE('30.06.2025', 'dd.mm.yyyy'));
INSERT INTO ZDRAVOTNA_POISTOVNA(PLATNOST_ZMLUVY) VALUES(TO_DATE('31.12.2027', 'dd.mm.yyyy'));
INSERT INTO ZDRAVOTNA_POISTOVNA(PLATNOST_ZMLUVY) VALUES(TO_DATE('31.08.2024', 'dd.mm.yyyy'));

INSERT INTO SKLAD(MNOZSTVO_TOVARU_NA_SKLADE, KAPACITA) VALUES('57','2250');
INSERT INTO SKLAD(MNOZSTVO_TOVARU_NA_SKLADE, KAPACITA) VALUES('380','2250');
INSERT INTO SKLAD(MNOZSTVO_TOVARU_NA_SKLADE, KAPACITA) VALUES('2250','2250');

COMMIT;

SELECT * FROM LEKAREN;
SELECT * FROM VYKAZ;
SELECT * FROM NAKUP;
SELECT * FROM LIEK;
SELECT * FROM ZDRAVOTNA_POISTOVNA;
